# 平衡三进制 Ⅱ (b-ternary-2.c)

## 题目描述

同`平衡三进制Ⅰ(b-ternary-1.c)`。

#### 举例

十进制数 `0` 到 `9` 的平衡三进制表示如下所示。

例如，$5_{10}=1×3^2+(−1)×3^1+(−1)×3^0=1ZZ_{b3}$

```
0    0
1    1
2    1Z
3    10
4    11
5    1ZZ
6    1Z0
7    1Z1
8    10Z
9    100
```

平衡三进制有两个有趣的性质：

> 性质一：已知某十进制数 $X_{10}$ 的平衡三进制表示 $X_{b3}$，则将 $X_{b3}$ 中的 `z` 变成 `1`，`1` 变成 `z`，便得到 $(-X)_{10}$ 的平衡三进制表示。

十进制数 `-1` 到 `-5` 的平衡三进制表示如下所示。

例如，$(-5)_{10} = (-1)×3^2+1×3^1+1×3^0=Z11_{b3}$

```
-1   Z
-2   Z1
-3   Z0
-4   ZZ
-5   Z11
```

> 性质二：每个十进制整数有且仅有一种平衡三进制表示。

#### 任务

请开发程序，帮这位同学完成十进制数与平衡三进制数之间的相互转换，本题为下半部分。

##### 十进制数转换为平衡三进制数

先将十进制数转换为传统的三进制数，先将十进制数转换为传统的三进制数，如 $64_{10} = 2101_3$，然后**从低位向高位**逐位处理：

- 若为 `1` 或 `0`，则保持不变；
- 若为 `2`，则替换为 `Z`，并向高位进位（即高位 `+1`）
- 若为 `3`（原来的 `2` 得到进位会变成 `3`），则替换为 `0`，并向高位进位（即高位 `+1`）

例如，$64_{10} = 2101_3 = 1Z101_{b3}$

十进制**负数**转换为平衡三进制数的方法可以参考性质一。

### 输入格式

输入共 n + 1 行：

- 第一行为 n，表示共需完成 n 个数字的进制转换
- 第二行到第 n + 1 行，每行由字符 `-`、`0`、`1`、`2`、`3`、`4`、`5`、`6`、`7`、`8`、`9`、`Z` 构成

输入满足以下条件：

- 输入的数字可能为 `0`，但没有前导零，也不会出现类似 `0000` 的全零情况

- 输入的数字若出现负号，则负号必定出现在首位

- 输入数字不为 `-0`

- 输入的数字

  可能并不是

  合法的十进制数

  - 你只需检查十进制数中是否会出现**非**`-0123456789`字符
  - `ctype.h` 或许对你有用

- `string.h` 中的 `strlen()` 函数或许对你有用

- `stdlib.h` 中的 `atoi()` 函数或许对你有用

### 输出格式

共 n 行。对于每一行：

- 若输入合法，则输出对应数字的平衡三进制表示
- 若输入不合法，则输出 `Radix Error`

### 测试样例

##### Input

------

```
4
64
237
-237
11Z51Z
```

##### Output

------

```
1Z101
100Z10
Z001Z0
Radix Error
```

### 题目注解

#### 数据规模与约定

对于 100% 的数据，满足如下条件：

- $n \leq 10000$
- 数字中的字符个数 $\leq 15$

- 若输入为合法的十进制数，则保证该数在 `[INT_MIN + 1, INT_MAX]` 范围内，相对应的平衡三进制数表示的长度 $\leq 21$



## 题解

### 思路

这道题要求将十进制数转换为平衡三进制数，并且处理一些错误情况。思路如下：

1. 先检查输入的字符串是否合法，即只包含数字字符和可能的负号。使用`isValidDecimal`函数来检查。
2. 如果输入是一个合法的十进制数，使用`strtol`函数将其转换为长整型，同时处理负号。如果转换后的长整型在整数范围内，那么可以继续进行下一步。
3. 将绝对值的长整型转换为平衡三进制数，使用`decimalToBalanceTernary`函数。
4. 如果输入是负数，根据性质一，将平衡三进制数中的'1'替换为'Z'，'Z'替换为'1'。
5. 最后输出平衡三进制数或者"Radix Error"。

### 解题方法

#### 1 函数 `isValidDecimal`

该函数检查输入字符串是否是一个合法的十进制数。它遍历输入字符串，检查每个字符是否是数字字符或者是否是唯一的负号（并且负号只出现在字符串的首位）。如果输入字符串包含其他字符，或者出现多个负号，那么它不是一个合法的十进制数。

#### 2 函数 `decimalToBalanceTernary`

该函数将一个正整数转换为平衡三进制数。它使用迭代方法，不断取余数和除法操作，将余数转换为对应的平衡三进制字符。需要注意的是，在余数为2的情况下，要将其转换为'Z'，并向高位进位（即加1）。

#### 3 主函数

在主函数中，首先读取输入的数量 `n`。然后，循环处理每个输入字符串：

1. 调用 `isValidDecimal` 检查输入是否合法。
2. 如果输入合法，使用 `strtol` 将其转换为长整型。
3. 根据长整型的范围，判断是否在整数范围内。如果不在范围内，输出"Radix Error"。
4. 如果在范围内，调用 `decimalToBalanceTernary` 将其转换为平衡三进制数。
5. 如果输入是负数，根据性质一，将平衡三进制数中的'1'替换为'Z'，'Z'替换为'1'。
6. 输出平衡三进制数或者"Radix Error"。

### 复杂度

- 时间复杂度：对于每个输入字符串，都需要遍历字符串来检查是否合法，并进行转换。因此，时间复杂度为 $O(n \cdot m)$，其中 $n$ 是输入数量，$m$ 是输入字符串的最大长度。
- 空间复杂度：除了输入字符串和输出结果之外，额外使用了一些变量来存储中间结果，空间复杂度为 $O(1)$。

### Code

```c

```

